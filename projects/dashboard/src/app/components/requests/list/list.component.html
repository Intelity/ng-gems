<div  class="service-card"
     (click)="goRequestDetails(row)"
     [ngClass]="{'active': (selectedRequest._id === row._id) }"
     *ngFor="let row of currentRequests; let i = index">
    <div class="room"
         [ngClass]="{'severe': row.severity === 'warning',
                          'critical':row.severity === 'critical'}">
        <div style="display:grid;place-items: center">
            <i *ngIf="row.hasRestaurant" ng-style="{'color': (row.channel | channelColor) }"
               class="fa fa-cutlery"></i>
            <svg *ngIf="!row.hasRestaurant" width="20" height="19" viewBox="0 0 20 19" xmlns="http://www.w3.org/2000/svg">
                <path d="M1.26482 6.45014C1.5569 6.55163 2.07139 6.77757 2.56134 7.28736C3.05129 7.79714 3.26845 8.33242 3.36599 8.63636C3.43622 8.85835 3.64051 9.04749 3.91304 9.04761C4.18557 9.04749 4.38986 8.85835 4.4601 8.63636C4.55764 8.33246 4.77479 7.79714 5.26474 7.28736C5.7547 6.77757 6.26923 6.55163 6.56126 6.45014C6.77462 6.37707 6.95641 6.16451 6.95652 5.88095C6.95641 5.59739 6.77462 5.38483 6.56126 5.31175C6.26919 5.21026 5.7547 4.98432 5.26474 4.47453C4.77479 3.96475 4.55764 3.42947 4.4601 3.12554C4.38986 2.90355 4.18557 2.7144 3.91304 2.71428C3.64051 2.7144 3.43622 2.90355 3.36599 3.12554C3.26845 3.42943 3.05129 3.96475 2.56134 4.47453C2.07139 4.98432 1.55686 5.21026 1.26482 5.31175C1.05147 5.38483 0.869679 5.59739 0.869564 5.88095C0.869679 6.16451 1.05147 6.37703 1.26482 6.45014Z" fill="{{row.channel | channelColor}}"></path>
                <path d="M9.56522 5.42857C9.56522 5.74661 9.81302 6.00445 10.1187 6.00445H10.7509V6.66222C10.7509 6.98026 10.9987 7.2381 11.3044 7.2381C11.61 7.2381 11.8578 6.98026 11.8578 6.66222V6.00445H12.49C12.7957 6.00445 13.0435 5.74661 13.0435 5.42857C13.0435 5.11053 12.7957 4.8527 12.49 4.8527H11.8578V4.19493C11.8578 3.87689 11.61 3.61905 11.3044 3.61905C10.9987 3.61905 10.7509 3.87689 10.7509 4.19493V4.8527H10.1187C9.81302 4.8527 9.56522 5.11053 9.56522 5.42857Z" fill="{{row.channel | channelColor}}"></path>
                <path d="M7.50999 2.3854H8.14216V3.04317C8.14216 3.36121 8.38997 3.61905 8.69563 3.61905C9.00129 3.61905 9.2491 3.36121 9.2491 3.04317V2.3854H9.88131C10.187 2.3854 10.4348 2.12756 10.4348 1.80952C10.4348 1.49149 10.187 1.23365 9.88131 1.23365H9.2491V0.575878C9.2491 0.25784 9.00129 0 8.69563 0C8.38997 0 8.14216 0.25784 8.14216 0.575878V1.23365H7.50999C7.20433 1.23365 6.95652 1.49149 6.95652 1.80952C6.95652 2.12756 7.20433 2.3854 7.50999 2.3854Z" fill="{{row.channel | channelColor}}"></path>

                <path d="M10.0705 16.7366C10.0893 16.7341 10.6266 16.6589 11.1299 16.2961C11.149 16.2823 11.1669 16.2676 11.1854 16.2534L12.1512 11.0887H12.5123C12.8056 11.0887 13.0435 10.8343 13.0435 10.5205C13.0435 10.2068 12.8056 9.95238 12.5123 9.95238H2.27035C1.97697 9.95238 1.73913 10.2068 1.73913 10.5205C1.73913 10.8343 1.97697 11.0887 2.27035 11.0887H2.63147L3.58519 16.189C3.64022 16.1519 3.69203 16.1078 3.73952 16.057L7.01573 12.553C7.22315 12.3311 7.55952 12.3311 7.76698 12.553C7.97444 12.7749 7.97444 13.1346 7.76698 13.3565L4.49077 16.8605C4.32206 17.041 4.08443 17.2181 3.79955 17.3354L4.02543 18.5433C4.07508 18.8088 4.29309 19 4.5463 19H8.7333C8.68319 18.8479 8.65249 18.6858 8.64459 18.5168C8.60231 17.6112 9.22812 16.8308 10.0705 16.7366Z" fill="{{row.channel | channelColor}}"></path>

                <path d="M2.46431 16.0486C2.13589 15.9105 1.92367 15.5879 1.92367 15.2264C1.92367 15.1186 1.94356 15.0139 1.98119 14.9164L1.71634 13.5714L1.42309 13.8693C1.06615 14.2318 0.869564 14.7137 0.869564 15.2268C0.869564 16.0224 1.33722 16.7332 2.06092 17.0377C2.58711 17.2591 3.0794 17.216 3.47826 17.0602L3.26558 15.9801C3.02866 16.1319 2.73124 16.1608 2.46431 16.0486Z" fill="{{row.channel | channelColor}}"></path>

                <path d="M17.3913 9.95238V0.540301C17.3913 0.241911 17.002 0 16.5217 0C16.0415 0 15.6522 0.241911 15.6522 0.540301V9.95238C15.9365 9.92799 16.2267 9.91514 16.5217 9.91514C16.8167 9.91514 17.1069 9.92799 17.3913 9.95238Z" fill="{{row.channel | channelColor}}"></path>

                <path d="M16.1563 11.7619C14.5164 11.7619 13.1822 13.0069 13.1822 14.5372C13.1822 17.6281 10.1512 17.9444 10.072 17.9523C9.7736 17.9801 9.55096 18.2215 9.56593 18.501C9.5809 18.7805 9.82808 19 10.128 19H14.3478C18.5861 19 19.1304 16.0227 19.1304 14.5371C19.1304 13.0069 17.7963 11.7619 16.1563 11.7619Z" fill="{{row.channel | channelColor}}"></path>
            </svg>
        </div>
        <div class="status-label">
            <div class="room-details">
                <span class="room-number">Room {{row.room || 'NA'}}</span>
                <span class="guest-name">(<span *ngIf="row.salutation">{{row.salutation + '. '}}</span>{{row.guest_name}})</span>
            </div>
            <div class="status-details">
                  <span class="label-black">
              {{row.status | ticketStatus:'service_request' | translate}}
              </span>
                <span class="label-black severity">{{row.severity}}</span>
                <span class="age">Due {{row.epochs | age}}</span>
            </div>
        </div>
    </div>
    <div class="inner-card">
        <div class="service-details">
            <div class="hidden-xs">
                <div class="service"><strong>Service:</strong> {{row.label}}</div>
                <div class="dept"><strong>Department:</strong>
                    {{row.channel | channels}}
                </div>
                <div class="delivery"><strong>Submitted:</strong>
                    {{row._created | affiliateTime:'D - MMM hh:mm A'}}
                </div>
            </div>
            <div class="visible-xs">
                <strong>{{row.channel | channels}} - {{row.label}}</strong>
                <hr>
                <span>{{row._created | affiliateTime:'DD-MMM hh:mm A'}}</span>
            </div>
            <div class="card-footer">
                <div class="ticket-quickaction" *ngIf="canUpdateRequests">
                    <!-- Split button -->
                    <div class="btn-group">
                        <button
                                *ngIf="row.status === 'new' || row.status === 'acknowledged' || row.status === 'assigned' || row.status === 'resolved' "
                                type="button" class="btn gems gems-blue action" style="font-weight: bolder;font-size:12px;"
                                (click)="advanceStatus(row, $event, i)"
                                [disabled]="!!row?.is_transitioning">
                            <translate *ngIf="row?.is_transitioning">Please Wait...</translate>
<!--                            <ng-container *ngIf="!row.is_transitioning">{{row.status | serviceTicketActions | translate}}-->
<!--                            </ng-container>-->
                        </button>
                        <button
                                *ngIf="row.status === 'new' || row.status === 'acknowledged' || row.status === 'assigned' || row.status === 'resolved' "
                                type="button" class="btn gems gems-blue"
                                (click)="toggleDropdown($event, 'list-of-statuses-' + i)" aria-haspopup="true"
                                aria-expanded="false" [disabled]="!!row?.is_transitioning"
                                style="font-weight: bolder!important;font-size:12px;">
                            <span class="caret"></span>
                            <span class="sr-only" translate>Toggle Dropdown</span>
                        </button>
                        <ul class="gems-dropdown quickaction list-of-statuses-{{i}}" style="right:6px;">
                            <li (click)="advanceStatus(row, $event, i, 'new')"><a translate>New</a></li>
                            <li (click)="advanceStatus(row, $event, i, 'acknowledged')">
                                <a translate>Acknowledge</a>
                            </li>
                            <li (click)="advanceStatus(row, $event, i, 'assigned')"><a translate>Assign</a></li>
                            <li (click)="advanceStatus(row, $event, i, 'resolved')"><a translate>Resolve</a></li>
                            <li (click)="advanceStatus(row, $event, i, 'closed')"><a translate>Close</a></li>
                            <li (click)="advanceStatus(row, $event, i, 'canceled')"><a translate>Cancel</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
